<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Installation_Guide.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Installation_Guide-system-requirements">
    <title>&OVIRT;系统需求</title>
    <section id="sect-Installation_Guide-system-requirements_Section_1">
        <title>系统需求之流程图解</title>
        <informalfigure>
            <mediaobject>
                <imageobject>
                    <imagedata
                        fileref="images/eayun_installation_checklist.png"
                        format="PNG" />
                </imageobject>
            </mediaobject>
        </informalfigure>
    </section>

    <section id="sect-Installation_Guide-system-requirements_Section_2">
        <title>硬件需求</title>
        <section id="sect-Installation_Guide-system-requirements_Section_2-1">
            <title>&OVIRT;硬件需求概览</title>
            <para>
                部署&OVIRT;虚拟化环境，最少应该满足以下设备要求：
                <itemizedlist>
                    <listitem>
                        <para>
                            1台&OVIRT;&MANAGER;服务器，
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            1台及以上的&OVIRT;&NODE;服务器（为了支持虚拟机迁移
                            以及电源管理，则最少应该准备2台&OVIRT;&NODE;
                            服务器），
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            1台及以上用于访问管理门户的客户端设备，
                        </para>
                    </listitem>
                    <listitem>
                        <para>
                            存储设备（NFS、POSIX文件系统、iSCSI存储、SAN存储或
                            者服务器本地存储设备）。
                        </para>
                    </listitem>
                </itemizedlist>
            </para>

            <para>
                上述几种类型的硬件需求在后面的章节中会详细说明。
            </para>

            <formalpara>
                <title>参见：</title>
                <para>
                    <itemizedlist>
                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-2">
                                    2.2.2 &OVIRT;&MANAGER;的硬件需求
                            </link></simpara>
                        </listitem>

                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-3">
                                    2.2.3 &OVIRT;&NODE;的硬件需求
                            </link></simpara>
                        </listitem>
                    </itemizedlist>
                </para>
            </formalpara>
        </section>

        <section id="sect-Installation_Guide-system-requirements_Section_2-2-2">
            <title>&OVIRT;&MANAGER;的硬件需求</title>
            <para>
                这里提供的最小和推荐硬件需求均针对典型部署方案而言，实际部署时请根据
                系统规模和负载情况考虑硬件配置。
            </para>

            <formalpara>
                <title>最小硬件需求</title>
                <para><itemizedlist>
                        <listitem>
                            <para>1颗双核CPU。</para>
                        </listitem>
                        <listitem>
                            <para>系统（部署&OVIRT;&MANAGER;之前）正常运行时可以保留4G空
                                闲内存。
                            </para>
                        </listitem>
                        <listitem>
                            <para>25G空闲磁盘空间。</para>
                        </listitem>
                        <listitem>
                            <para>1块千兆（或者更高速率）网卡。</para>
                        </listitem>
                </itemizedlist></para>
            </formalpara>

            <formalpara>
                <title>建议硬件需求</title>
                <para><itemizedlist>
                        <listitem>
                            <para>1颗及以上双核CPU。</para>
                        </listitem>
                        <listitem>
                            <para>16G内存。</para>
                        </listitem>
                        <listitem>
                            <para>50G本地空闲磁盘空间。</para>
                        </listitem>
                        <listitem>
                            <para>1块千兆（或者更高速率）网卡。</para>
                        </listitem>
                </itemizedlist></para>
            </formalpara>
        </section>

        <section id="sect-Installation_Guide-system-requirements_Section_2-2-3">
            <title>&OVIRT;&NODE;的硬件需求</title>

            <section id="sect-Installation_Guide-system-requirements_Section_2-2-3-1">
                <title>&OVIRT;&NODE;的硬件需求概览</title>
                <para>
                    &OVIRT;&NODE;的硬件需求分章节介绍如下：

                    <itemizedlist>
                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-3-2">
                                    2.2.3.2 &OVIRT;&NODE;对于CPU的要求
                            </link></simpara>
                        </listitem>

                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-3-3">
                                    2.2.3.3 &OVIRT;&NODE;对于系统内存的要求
                            </link></simpara>
                        </listitem>

                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-3-4">
                                    2.2.3.4 &OVIRT;&NODE;对于存储空间的要求
                            </link></simpara>
                        </listitem>

                        <listitem>
                            <simpara><link linkend=
                                    "sect-Installation_Guide-system-requirements_Section_2-2-3-5">
                                    2.2.3.5 &OVIRT;&NODE;对于PCI设备的要求
                            </link></simpara>
                        </listitem>
                    </itemizedlist>
                </para>
            </section>

            <section id="sect-Installation_Guide-system-requirements_Section_2-2-3-2">
                <title>&OVIRT;&NODE;对于CPU的要求</title>

                <para>
                    &OVIRT;&NODE;支持以下型号的CPU：

                    <itemizedlist>
                        <listitem>
                            <simpara>AMD Operton G1</simpara>
                        </listitem>
                        <listitem>
                            <simpara>AMD Operton G2</simpara>
                        </listitem>
                        <listitem>
                            <simpara>AMD Operton G3</simpara>
                        </listitem>
                        <listitem>
                            <simpara>AMD Operton G4</simpara>
                        </listitem>
                        <listitem>
                            <simpara>AMD Operton G5</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Conroe</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Penryn</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Nehalem</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Westmere</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Sandybridge</simpara>
                        </listitem>
                        <listitem>
                            <simpara>Intel Haswell</simpara>
                        </listitem>
                    </itemizedlist>
                </para>

                <para>
                    CPU必须支持64位技术（Intel&reg; 64 or AMD64），支持
                    AMD-V&trade;或者Intel VT&reg;虚拟化技术。另外CPU也必须支持
                    NX技术（No eXecute）。部署之前需要检查CPU是否满足上述要求：
                    <itemizedlist>
                        <listitem>
                            <para>
                                使用&OVIRT;&NODE;安装光盘引导服务器，进入救援模
                                式（rescue）；
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                出现提示符，执行下面的命令：
                                <screen># grep -E 'svm|vmx' /proc/cpuinfo | grep nx
                                </screen>
                                如果有输出，说明CPU支持虚拟化技术。某些服务器的
                                BIOS中提供了禁用虚拟化技术的选项，需要根据硬件手
                                册确认或者咨询生产厂商。
                            </para>
                        </listitem>
                        <listitem>
                            <para>
                                检查内核模块kvm有没有加载：
                                <screen># lsmod | grep kvm
                                </screen>
                                如果输入中包含kvm_intel或者kvm_amd说明模块已经正
                                确加载，CPU满足虚拟化技术的要求。
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            </section>

            <section id="sect-Installation_Guide-system-requirements_Section_2-2-3-3">
                <title>&OVIRT;&NODE;对于系统内存的要求</title>
                <para>
                    建议&OVIRT;&NODE;服务器配置2G以上的内存。以下因素对实际内存
                    的需求产生影响：
                    <itemizedlist>
                        <listitem>
                            <simpara>虚拟机操作系统对内存的使用；
                            </simpara>
                        </listitem>
                        <listitem>
                            <simpara>虚拟机中运行的应用程序对内存的使用；
                            </simpara>
                        </listitem>
                        <listitem>
                            <simpara>虚拟机本身对内存的使用。
                            </simpara>
                        </listitem>
                    </itemizedlist>
                </para>
                <para>
                    KVM使用了内存over-commit技术改善了对虚拟机内存申请的管理，允
                    许在所有虚拟机不是都处于高负载的情况下满足一些虚拟机申请超过
                    物理限制数量的内存。
                </para>
                <para>
                    目前&OVIRT;&NODE;支持最大2T内存。
                </para>
            </section>

            <section id="sect-Installation_Guide-system-requirements_Section_2-2-3-4">
                <title>&OVIRT;&NODE;对于存储空间的要求</title>
                <para>
                    建议&OVIRT;&NODE;至少应该配置2G存储空间，包括：
                    <itemizedlist>
                        <listitem>
                            <simpara>根分区至少需要500M；
                            </simpara>
                        </listitem>
                        <listitem>
                            <simpara>配置文件分区至少需要8M；
                            </simpara>
                        </listitem>
                        <listitem>
                            <simpara>日志分区建议至少使用2048M；
                            </simpara>
                        </listitem>
                        <listitem>
                            <para>数据分区至少使用256M。数据分区过小会导致后期无
                                法进行扩展或者更新。默认情况下，其他分区划分完成
                                之后，所有空闲的存储空间都会分配给数据分区。
                            </para>
                        </listitem>
                        <listitem>
                            <para>swap分区至少需要8M。swap分区的推荐大小由服务器
                                的配置，以及内存overcommit的配置决定。&OVIRT;&NODE;
                                中内存overcommit默认的比例为0.5。可以通过下面的
                                公式确定swap分区的大小：
                                <itemizedlist>
                                    <listitem>
                                        <simpara>
                                            将物理内存总量乘以overcommit比例，加上
                                        </simpara>
                                    </listitem>
                                    <listitem>
                                        <simpara>
                                            2G（如果系统内存小于等于4G），或者
                                        </simpara>
                                    </listitem>
                                    <listitem>
                                        <simpara>
                                            4G（如果系统内存大于4G小于16G），或者
                                        </simpara>
                                    </listitem>
                                    <listitem>
                                        <simpara>
                                            8G（如果系统内存大于16G小于64G），或者
                                        </simpara>
                                    </listitem>
                                    <listitem>
                                        <simpara>
                                            16G（如果系统内存大于64G小于256G），或者
                                        </simpara>
                                    </listitem>
                                </itemizedlist>
                                <example>
                                    <title>计算swap分区大小</title>
                                    <para>对于配置了8G物理内存的服务器来
                                        说，使用上面的说明可以计算得出：
                                        <screen>(8 GB x 0.5) + 4 GB = 8 GB
                                        </screen>
                                    </para>
                                </example>
                                <important>
                                    <para>&OVIRT;&NODE;安装时会自动使用上述公式
                                        计算swap分区大小，内存overcommit比例为
                                        0.5。某些情况下，计算得出的swap分区大小
                                        超过了本地磁盘的剩余空间，导致&OVIRT;&NODE;
                                        安装失败。此时可以通过storage_vol引导参
                                        数手动设置分区大小。
                                        <example>
                                            <title>手动设置swap分区大小</title>
                                            <para>下面的示例，只设置swap分区大小
                                                为4096M，没有设置其他分区的大
                                                小，由安装程序自行确定。
                                                <screen>storage_vol=:4096::::
                                                </screen>
                                            </para>
                                        </example>
                                    </para>
                                </important>
                                <important>
                                    <para>&OVIRT;&NODE;不支持安装在fakeraid设备
                                        上。使用fakeraid设备时必须重新配置为
                                        non-RAID的模式。
                                        <orderedlist>
                                            <listitem><simpara>
                                                    进入RAID控制器的BIOS，删除所
                                                    有LUN。
                                            </simpara></listitem>
                                            <listitem><simpara>
                                                    将控制器设置为non-RAID模式
                                                    （“compatibility”或者“JBOD”
                                                    选项，具体需要资源硬件厂商）。
                                            </simpara></listitem>
                                        </orderedlist>
                                        具体的配置方法和说明请咨询硬件厂商。
                                    </para>
                                </important>
                            </para>
                        </listitem>
                    </itemizedlist>
                </para>
            </section>

            <section id="sect-Installation_Guide-system-requirements_Section_2-2-3-5">
                <title>&OVIRT;&NODE;对于PCI设备的要求</title>
                <para></para>
            </section>
        </section>
    </section>
    <section id="sect-Installation_Guide-system-requirements_Section_3">
        <title>软件需求</title>
        <para>
            This is a test paragraph in a section
        </para>
    </section>

</chapter>

